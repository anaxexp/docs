



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="AnaxExp documentation">
      
      
        <link rel="canonical" href="https://docs.anaxexp.io/stacks/drupal/">
      
      
        <meta name="author" content="AnaxExp, LLC.">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.1, mkdocs-material-3.0.3">
    
    
      
        <title>Overview - AnaxExp documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../assets/anaxexp.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../#drupal-stack-documentation" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.anaxexp.io" title="AnaxExp documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                AnaxExp documentation

                <span class="stack-page-link-wrapper">
                  <a href="https://anaxexp.com/stacks" class="stack-page-link" target="_blank">
                    Browse stacks
                  </a>
                </span>
              </span>
              <span class="md-header-nav__topic">
                Overview
              </span>
            
          
        </div>
      </div>

      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>

      
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          


  


  <a href="https://github.com/anaxexp/docs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      anaxexp/docs
    </div>
  </a>

        </div>
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        



<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
      
  <li class="md-tabs__item">
    
      <a href="../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
  
  
    <li class="md-tabs__item">
      
        <a href="../../apps/new/" title="Apps" class="md-tabs__link">
          Apps
        </a>
      
    </li>
  

      
      
  
  
    <li class="md-tabs__item">
      
        <a href="../../infrastructure/" title="Infrastructure" class="md-tabs__link">
          Infrastructure
        </a>
      
    </li>
  

      
      
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Stacks" class="md-tabs__link md-tabs__link--active">
          Stacks
        </a>
      
    </li>
  

      
      
  
  
    <li class="md-tabs__item">
      
        <a href="../../integrations/aws/" title="Integrations" class="md-tabs__link">
          Integrations
        </a>
      
    </li>
  

      
      
  
  
    <li class="md-tabs__item">
      
        <a href="../../cluster/" title="Cluster" class="md-tabs__link">
          Cluster
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.anaxexp.io" title="AnaxExp documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    AnaxExp documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/anaxexp/docs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      anaxexp/docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../billing/" title="Billing" class="md-nav__link">
      Billing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../dev/" title="Development" class="md-nav__link">
      Development
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../status/" title="Status" class="md-nav__link">
      Status
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../support/" title="Support" class="md-nav__link">
      Support
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../roles/" title="User roles" class="md-nav__link">
      User roles
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Apps
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Apps
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/new/" title="New app" class="md-nav__link">
      New app
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/instances/" title="Instances" class="md-nav__link">
      Instances
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/deploy/" title="Deployment" class="md-nav__link">
      Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/domains/" title="Domains" class="md-nav__link">
      Domains
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/backups/" title="Backups" class="md-nav__link">
      Backups
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/logs/" title="Logging" class="md-nav__link">
      Logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apps/post-deployment-scripts/" title="Post-deployment scripts" class="md-nav__link">
      Post-deployment scripts
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Infrastructure
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Infrastructure
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../infrastructure/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../infrastructure/connecting-server/" title="Connecting server" class="md-nav__link">
      Connecting server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../infrastructure/containers/" title="Containers" class="md-nav__link">
      Containers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../infrastructure/monitoring/" title="Monitoring" class="md-nav__link">
      Monitoring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../infrastructure/env-vars/" title="Environment variables" class="md-nav__link">
      Environment variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../infrastructure/disk/" title="Disk" class="md-nav__link">
      Disk
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../infrastructure/maintenance/" title="Maintenance" class="md-nav__link">
      Maintenance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../infrastructure/security/" title="Security" class="md-nav__link">
      Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../infrastructure/hsts/" title="HSTS" class="md-nav__link">
      HSTS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../infrastructure/ufw/" title="UFW" class="md-nav__link">
      UFW
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../infrastructure/cli/" title="CLI" class="md-nav__link">
      CLI
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11" checked>
    
    <label class="md-nav__link" for="nav-11">
      Stacks
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Stacks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../config/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../template/" title="Template" class="md-nav__link">
      Template
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../maintenance/" title="Maintenance" class="md-nav__link">
      Maintenance
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-5" type="checkbox" id="nav-11-5" checked>
    
    <label class="md-nav__link" for="nav-11-5">
      Drupal
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-11-5">
        Drupal
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Overview
      </label>
    
    <a href="./" title="Overview" class="md-nav__link md-nav__link--active">
      Overview
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deployment" title="Deployment" class="md-nav__link">
    Deployment
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vanilla-drupal" title="Vanilla Drupal" class="md-nav__link">
    Vanilla Drupal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direct-git-integration" title="Direct git integration" class="md-nav__link">
    Direct git integration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cicd" title="CI/CD" class="md-nav__link">
    CI/CD
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#drush" title="Drush" class="md-nav__link">
    Drush
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import" title="Import" class="md-nav__link">
    Import
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-drush-archive" title="From drush archive" class="md-nav__link">
    From drush archive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-separate-archives" title="From separate archives" class="md-nav__link">
    From separate archives
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-import" title="Manual import" class="md-nav__link">
    Manual import
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-between-instances" title="Import between instances" class="md-nav__link">
    Import between instances
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backups" title="Backups" class="md-nav__link">
    Backups
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#files" title="Files" class="md-nav__link">
    Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database" title="Database" class="md-nav__link">
    Database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#drupal-settings" title="Drupal settings" class="md-nav__link">
    Drupal settings
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-site" title="Default site" class="md-nav__link">
    Default site
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#settingsphp" title="settings.php" class="md-nav__link">
    settings.php
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sitesphp" title="sites.php" class="md-nav__link">
    sites.php
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trusted-hosts-patterns" title="Trusted hosts patterns" class="md-nav__link">
    Trusted hosts patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sync-directory" title="Sync directory" class="md-nav__link">
    Sync directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files_1" title="Files" class="md-nav__link">
    Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#base-url" title="Base URL" class="md-nav__link">
    Base URL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mail-delivery" title="Mail delivery" class="md-nav__link">
    Mail delivery
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cron" title="Cron" class="md-nav__link">
    Cron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redirects" title="Redirects" class="md-nav__link">
    Redirects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-site" title="Multi-site" class="md-nav__link">
    Multi-site
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploy-sites-as-separate-app-instances" title="Deploy sites as separate app instances" class="md-nav__link">
    Deploy sites as separate app instances
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-all-sites-in-one-instance" title="Deploy all sites in one instance" class="md-nav__link">
    Deploy all sites in one instance
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cache-control" title="Cache control" class="md-nav__link">
    Cache control
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="containers/" title="Containers" class="md-nav__link">
      Containers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="local/" title="Local environment" class="md-nav__link">
      Local environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-6" type="checkbox" id="nav-11-6">
    
    <label class="md-nav__link" for="nav-11-6">
      WordPress
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-11-6">
        WordPress
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../wordpress/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wordpress/containers/" title="Containers" class="md-nav__link">
      Containers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wordpress/local/" title="Local environment" class="md-nav__link">
      Local environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wordpress/changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-7" type="checkbox" id="nav-11-7">
    
    <label class="md-nav__link" for="nav-11-7">
      PHP
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-11-7">
        PHP
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../php/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../php/containers/" title="Containers" class="md-nav__link">
      Containers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../php/local/" title="Local environment" class="md-nav__link">
      Local environment
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-8" type="checkbox" id="nav-11-8">
    
    <label class="md-nav__link" for="nav-11-8">
      GitLab
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-11-8">
        GitLab
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gitlab/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gitlab/changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../html/" title="HTML" class="md-nav__link">
      HTML
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../matomo/" title="Matomo" class="md-nav__link">
      Matomo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cachet/" title="Cachet" class="md-nav__link">
      Cachet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mariadb/" title="MariaDB" class="md-nav__link">
      MariaDB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../postgres/" title="PostgreSQL" class="md-nav__link">
      PostgreSQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../solr/" title="Solr" class="md-nav__link">
      Solr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../solr-drupal/" title="Solr for Drupal" class="md-nav__link">
      Solr for Drupal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../opensmtpd/" title="OpenSMTPD" class="md-nav__link">
      OpenSMTPD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elasticsearch/" title="Elasticsearch" class="md-nav__link">
      Elasticsearch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../athenapdf/" title="AthenaPDF" class="md-nav__link">
      AthenaPDF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../redis/" title="Redis" class="md-nav__link">
      Redis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../varnish/" title="Varnish" class="md-nav__link">
      Varnish
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../jenkins/" title="Jenkins" class="md-nav__link">
      Jenkins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-registry/" title="Docker registry" class="md-nav__link">
      Docker registry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../slackin/" title="Slackin" class="md-nav__link">
      Slackin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      Integrations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        Integrations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/aws/" title="AWS" class="md-nav__link">
      AWS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/azure/" title="Azure" class="md-nav__link">
      Azure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/bitbucket/" title="BitBucket" class="md-nav__link">
      BitBucket
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/cloudflare/" title="CloudFlare" class="md-nav__link">
      CloudFlare
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/digitalocean/" title="DigitalOcean" class="md-nav__link">
      DigitalOcean
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/docker-registry/" title="Docker registry" class="md-nav__link">
      Docker registry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/gcp/" title="GCP" class="md-nav__link">
      GCP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/github/" title="GitHub" class="md-nav__link">
      GitHub
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/gitlab/" title="GitLab" class="md-nav__link">
      GitLab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/linode/" title="Linode" class="md-nav__link">
      Linode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/sendgrid/" title="SendGrid" class="md-nav__link">
      SendGrid
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/custom/" title="Custom provider" class="md-nav__link">
      Custom provider
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      Cluster
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        Cluster
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cluster/" title="Kubernetes cluster" class="md-nav__link">
      Kubernetes cluster
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deployment" title="Deployment" class="md-nav__link">
    Deployment
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vanilla-drupal" title="Vanilla Drupal" class="md-nav__link">
    Vanilla Drupal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direct-git-integration" title="Direct git integration" class="md-nav__link">
    Direct git integration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cicd" title="CI/CD" class="md-nav__link">
    CI/CD
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#drush" title="Drush" class="md-nav__link">
    Drush
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import" title="Import" class="md-nav__link">
    Import
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-drush-archive" title="From drush archive" class="md-nav__link">
    From drush archive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-separate-archives" title="From separate archives" class="md-nav__link">
    From separate archives
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-import" title="Manual import" class="md-nav__link">
    Manual import
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-between-instances" title="Import between instances" class="md-nav__link">
    Import between instances
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backups" title="Backups" class="md-nav__link">
    Backups
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#files" title="Files" class="md-nav__link">
    Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database" title="Database" class="md-nav__link">
    Database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#drupal-settings" title="Drupal settings" class="md-nav__link">
    Drupal settings
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-site" title="Default site" class="md-nav__link">
    Default site
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#settingsphp" title="settings.php" class="md-nav__link">
    settings.php
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sitesphp" title="sites.php" class="md-nav__link">
    sites.php
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trusted-hosts-patterns" title="Trusted hosts patterns" class="md-nav__link">
    Trusted hosts patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sync-directory" title="Sync directory" class="md-nav__link">
    Sync directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files_1" title="Files" class="md-nav__link">
    Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#base-url" title="Base URL" class="md-nav__link">
    Base URL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mail-delivery" title="Mail delivery" class="md-nav__link">
    Mail delivery
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cron" title="Cron" class="md-nav__link">
    Cron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redirects" title="Redirects" class="md-nav__link">
    Redirects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-site" title="Multi-site" class="md-nav__link">
    Multi-site
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploy-sites-as-separate-app-instances" title="Deploy sites as separate app instances" class="md-nav__link">
    Deploy sites as separate app instances
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-all-sites-in-one-instance" title="Deploy all sites in one instance" class="md-nav__link">
    Deploy all sites in one instance
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cache-control" title="Cache control" class="md-nav__link">
    Cache control
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/anaxexp/docs/edit/master/docs/stacks/drupal/index.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="drupal-stack-documentation">Drupal stack documentation<a class="headerlink" href="#drupal-stack-documentation" title="Permanent link">&para;</a></h1>
<p>Stack pages:</p>
<ul>
<li><a href="https://cloud.anaxexp.com/stackhub/ada51e9b-2204-45ee-8e49-a4151912a168/overview">Drupal 8</a></li>
<li><a href="https://cloud.anaxexp.com/stackhub/35e3e058-936b-4695-9871-08c855aae898/overview">Drupal 7</a></li>
<li><a href="https://cloud.anaxexp.com/stackhub/0ade1c32-7b75-41ad-b796-4de97fb7dc4e/overview">Drupal 6</a></li>
<li><a href="https://github.com/anaxexp/drupal4docker">Drupal4Docker (local environment)</a></li>
</ul>
<h2 id="deployment">Deployment<a class="headerlink" href="#deployment" title="Permanent link">&para;</a></h2>
<p>See <a href="../../apps/deploy/">main code deployment article</a> to learn about code deployment options on AnaxExp. </p>
<h3 id="vanilla-drupal">Vanilla Drupal<a class="headerlink" href="#vanilla-drupal" title="Permanent link">&para;</a></h3>
<p>For demo purposes and simple Drupal installations you can use Vanilla Drupal deployment option. In this case Drupal code that comes with the Docker image will be used. In case of changes all data made to your codebase will persist but there will be no versions control.</p>
<h3 id="direct-git-integration">Direct git integration<a class="headerlink" href="#direct-git-integration" title="Permanent link">&para;</a></h3>
<p>We recommend using <a href="https://getcomposer.org/">Composer</a> to manage dependencies in your repository. Dependencies will be installed via <a href="../../apps/post-deployment-scripts/">post-deployment scripts</a>:</p>
<ol>
<li>Fork <a href="https://github.com/anaxexp/drupal-composer">our boilerplate</a> or use the original <a href="https://github.com/drupal-composer/drupal-project">composer template for Drupal</a></li>
<li>Create <code>anaxexp.yml</code> in repository root (our boilerplate already has it) with the following content:
  <div class="codehilite"><pre><span></span>pipeline:
  - name: Install dependencies
    type: command
    command: composer install --prefer-dist -n --no-dev
    directory: $APP_ROOT
</pre></div></li>
<li>On the 3<sup>rd</sup> step of new application deployment form:<ul>
<li>Specify <code>web</code> in <code>Codebase dir</code> (default name of subdir with Drupal's codebase) </li>
<li>Make sure git branch matches to your Drupal version</li>
</ul>
</li>
</ol>
<h3 id="cicd">CI/CD<a class="headerlink" href="#cicd" title="Permanent link">&para;</a></h3>
<div class="admonition tldr">
<p class="admonition-title">CI/CD tutorial</p>
<p>For a detailed instructions of setting up CI/CD workflow see the main <a href="../../apps/deploy/#cicd">deployment article</a></p>
</div>
<p>The following services are CI services that will be built by default:</p>
<ul>
<li><code>php</code></li>
<li><code>crond</code></li>
<li><code>sshd</code></li>
<li>HTTP server: <code>nginx</code> or <code>apache</code></li>
</ul>
<h2 id="drush">Drush<a class="headerlink" href="#drush" title="Permanent link">&para;</a></h2>
<p>You can execute drush commands remotely via drush aliases. Download drush aliases from <code>Profile &gt; Misc &gt; Drush aliases</code> page and place them to <code>~/.drush</code>. Execute commands (replace <code>[tokens]</code> with the real values) like this:</p>
<div class="codehilite"><pre><span></span>$  drush @<span class="o">[</span>organization<span class="o">]</span>.<span class="o">[</span>application<span class="o">]</span>.<span class="o">[</span>instance<span class="o">]</span> <span class="o">[</span>drush command<span class="o">]</span>
</pre></div>

<p>The domain marked as primary will be used as <code>-l</code> for drush aliases.</p>
<h2 id="import">Import<a class="headerlink" href="#import" title="Permanent link">&para;</a></h2>
<h3 id="from-drush-archive">From drush archive<a class="headerlink" href="#from-drush-archive" title="Permanent link">&para;</a></h3>
<p>This option is available on the 3<sup>rd</sup> step of a new application deployment form.</p>
<p>First, make sure you have <a href="http://www.drush.org/en/master/install/">Drush installed</a>, go to your Drupal root directory and execute a command:</p>
<div class="codehilite"><pre><span></span>$ drush archive-dump
</pre></div>

<p>or</p>
<div class="codehilite"><pre><span></span>$ drush ard
</pre></div>

<p>You should see output like:</p>
<div class="codehilite"><pre><span></span>$ drush ard
Archive saved to /Users/johndoe/drush-backups/archive-dump/20150604001227/drupalapp.20150604_001228.tar.gz
/Users/johndoe/drush-backups/archive-dump/20150604001227/drupalapp.20150604_001228.tar.gz
</pre></div>

<p>Now navigate to <code>Apps &gt; Deploy</code> and choose drush archive on the 3<sup>rd</sup> step</p>
<h3 id="from-separate-archives">From separate archives<a class="headerlink" href="#from-separate-archives" title="Permanent link">&para;</a></h3>
<p>Import Drupal via separate archives for database and files. We support <code>.zip</code>, <code>.gz</code>, <code>.tar.gz</code>, <code>.tgz</code> and <code>.tar</code> archives. This option is available on the 3<sup>rd</sup> step of a new application deployment form and also on <code>[Instance] &gt; Import</code> page of existing instance.</p>
<h3 id="manual-import">Manual import<a class="headerlink" href="#manual-import" title="Permanent link">&para;</a></h3>
<p>In case your import data is huge it makes sense to import it manually from the server. Follow these steps:</p>
<ol>
<li>Deploy your Drupal website from a git repository without importing data</li>
<li>Once the app is deployed, go to <code>Stack &gt; SSH</code> and copy SSH command</li>
<li>Connect to the container by SSH</li>
<li>Copy your database archive here via <code>wget</code> or <code>scp</code>, make sure it's gzipped</li>
<li>Import unpacked database dump using <code>drush sql-cli &lt; my-db-dump.sql</code></li>
<li>Now let's import your files, cd to <code>/mnt/files</code>, use public and private subdirectories according to your needs</li>
<li>Copy your files archive here via <code>wget</code> or <code>scp</code> and unpack the archive</li>
<li>That's it! Clear Drupal cache and remove import artifacts</li>
</ol>
<h3 id="import-between-instances">Import between instances<a class="headerlink" href="#import-between-instances" title="Permanent link">&para;</a></h3>
<p>You can import database and files from one instance to another regardless of whether instances are on the same server or not. Go to <code>[Instance] &gt; Import</code> tab and select an instance where you'd like to import database/files from.</p>
<h2 id="backups">Backups<a class="headerlink" href="#backups" title="Permanent link">&para;</a></h2>
<h3 id="files">Files<a class="headerlink" href="#files" title="Permanent link">&para;</a></h3>
<p>Both public and private files directories under <code>sites/*/files</code> will be backed up. Codebase will not be backed up.  </p>
<h3 id="database">Database<a class="headerlink" href="#database" title="Permanent link">&para;</a></h3>
<p>MariaDB backups run with <a href="https://dev.mysql.com/doc/refman/5.7/en/mysqldump.html">--single-transaction</a> option to avoid tables locks.</p>
<p>Data of the following tables excluded from DB dump:</p>
<div class="codehilite"><pre><span></span>cache
cache_%
ctools_object_cache
ctools_views_cache
flood
history
queue
search_index
semaphore
sequences
sessions
watchdog
</pre></div>

<h2 id="drupal-settings">Drupal settings<a class="headerlink" href="#drupal-settings" title="Permanent link">&para;</a></h2>
<h3 id="default-site">Default site<a class="headerlink" href="#default-site" title="Permanent link">&para;</a></h3>
<p>When you deploy a new Drupal application you can optionally specify <code>Site directory</code> on the 3<sup>rd</sup> step, if not specified we use <code>default</code>. If directory does not exist AnaxExp will create it automatically. For example if you have a directory <code>sites/my-drupal-site/*</code> you should specify <code>my-drupal-site</code>. This directory will be used to locate <a href="#settings-php"><code>settings.php</code></a> file and for building <a href="#sites-php"><code>sites.php</code></a> mapping. The default <a href="#cron">cron job</a> and orchestrations performed from AnaxExp dashboard such Drupal cache flush will be applied for this site.</p>
<h3 id="settingsphp">settings.php<a class="headerlink" href="#settingsphp" title="Permanent link">&para;</a></h3>
<p>AnaxExp automatically adds the include of <code>anaxexp.settings.php</code> to <a href="#default-site">default site's</a> <code>settings.php</code>. The <code>anaxexp.settings.php</code> file contains configuration settings for integration with AnaxExp services such as Database, Cache storage and Reverse Caching Proxy. You can override settings from this file in your <code>sites/*/settings.php</code> file after the include of <code>anaxexp.settings.php</code>. If your <code>settings.php</code> file already has the line with <code>anaxexp.settings.php</code> include the include will not be added again. Do not edit <code>anaxexp.settings.php</code>, all changes to this file will be reset with the next deployment.</p>
<h3 id="sitesphp">sites.php<a class="headerlink" href="#sitesphp" title="Permanent link">&para;</a></h3>
<p>AnaxExp automatically adds the include of <code>anaxexp.sites.php</code> to <code>sites.php</code>. The file <code>anaxexp.sites.php</code> generated automatically and contains the mapping of all attached domains to the site directory you've specified for this application.</p>
<h3 id="trusted-hosts-patterns">Trusted hosts patterns<a class="headerlink" href="#trusted-hosts-patterns" title="Permanent link">&para;</a></h3>
<p>All domains attached to an HTTP server (Nginx or Apache) or Varnish will be added to Drupal's trusted hosts patterns. </p>
<h3 id="sync-directory">Sync directory<a class="headerlink" href="#sync-directory" title="Permanent link">&para;</a></h3>
<p>AnaxExp automatically creates sync directory with a salt and specify it inside of <code>anaxexp.settings.php</code>.</p>
<h3 id="files_1">Files<a class="headerlink" href="#files_1" title="Permanent link">&para;</a></h3>
<p>Files for Drupal located in <code>/mnt/files</code> and symlinked to <code>sites/[SITE NAME]/files</code>.</p>
<h3 id="base-url">Base URL<a class="headerlink" href="#base-url" title="Permanent link">&para;</a></h3>
<p>The domain marked with primary flag will be used as a <code>$base_url</code> in <a href="#settings-php"><code>settings.php</code></a> file and as an <code>-l</code> parameter for the <a href="#cron">default cron job</a>. </p>
<h2 id="mail-delivery">Mail delivery<a class="headerlink" href="#mail-delivery" title="Permanent link">&para;</a></h2>
<div class="admonition warning">
<p class="admonition-title">No delivery guarantee</p>
<p>If you're using a server from a public cloud there's a good chance that its IP is already compromised and blacklisted by major mail services, hence your emails will not be delivered or will land in the spam folder. We strongly recommend using OpenSMTPD <a href="../opensmtpd/#integration-with-3rd-party-smtp-servers">in pair with a third-party SMTP services</a>.</p>
</div>
<p>Mail transfer agent <a href="../opensmtpd/">OpenSMTPD</a> included in the stack and used as a default mail delivery service. Emails will be sent from the server hosting your application. Additionally, you can enable mail catcher service <a href="containers/#mailhog">Mailhog</a> to catch all outbound emails and release them manually from UI to an SMTP server. You can switch an active mail delivery service from <code>Application &gt; Stack &gt; Settings</code> page.</p>
<h2 id="cron">Cron<a class="headerlink" href="#cron" title="Permanent link">&para;</a></h2>
<p>By default we run the following cron command from <a href="containers/#crond">crond container</a> every hour:</p>
<div class="codehilite"><pre><span></span>drush -r &quot;${HTTP_ROOT}&quot; -l &quot;${ANAXEXP_HOST_PRIMARY}&quot; cron
</pre></div>

<p><code>$ANAXEXP_HOST_PRIMARY</code> is a domain marked as primary. You can customize crontab from <code>[Instance] &gt; Stack &gt; Settings</code> page.</p>
<h2 id="redirects">Redirects<a class="headerlink" href="#redirects" title="Permanent link">&para;</a></h2>
<p>If you need to make a redirect from one domain to another you can do it by customizing configuration files of nginx or by adding the snippets below to your <code>settings.php</code> file.</p>
<p>Redirect from one domain to another:</p>
<div class="codehilite"><pre><span></span><span class="x">if (isset($_SERVER[&#39;ANAXEXP_ENVIRONMENT_TYPE&#39;]) &amp;&amp; $_SERVER[&#39;ANAXEXP_ENVIRONMENT_TYPE&#39;] == &#39;prod&#39; &amp;&amp; php_sapi_name() != &quot;cli&quot;) {</span>
<span class="x">    if ($_SERVER[&#39;HTTP_HOST&#39;] == &#39;redirect-from-domain.com&#39;) {</span>
<span class="x">      header(&#39;HTTP/1.0 301 Moved Permanently&#39;);</span>
<span class="x">      header(&#39;Location: http://redirect-to-domain.com&#39; . $_SERVER[&#39;REQUEST_URI&#39;]);</span>
<span class="x">      exit();</span>
<span class="x">    }</span>
<span class="x">}</span>
</pre></div>

<p>Redirect from multiple domains:</p>
<div class="codehilite"><pre><span></span><span class="x">if (isset($_SERVER[&#39;ANAXEXP_ENVIRONMENT_TYPE&#39;]) &amp;&amp; $_SERVER[&#39;ANAXEXP_ENVIRONMENT_TYPE&#39;] == &#39;prod&#39; &amp;&amp; php_sapi_name() != &quot;cli&quot;) {</span>
<span class="x">    $redirect_from = array(</span>
<span class="x">      &#39;redirect-from-domain-1.com&#39;,</span>
<span class="x">      &#39;redirect-from-domain-2.com&#39;,</span>
<span class="x">    );</span>

<span class="x">    if (in_array($_SERVER[&#39;HTTP_HOST&#39;], $redirect_from)) {</span>
<span class="x">      header(&#39;HTTP/1.0 301 Moved Permanently&#39;);</span>
<span class="x">      header(&#39;Location: http://redirect-to-domain.com&#39; . $_SERVER[&#39;REQUEST_URI&#39;]);</span>
<span class="x">      exit();</span>
<span class="x">    }</span>
<span class="x">}</span>
</pre></div>

<p>Redirect from HTTP to HTTPS can be enabled on a domain edit page from the dashboard.</p>
<h2 id="multi-site">Multi-site<a class="headerlink" href="#multi-site" title="Permanent link">&para;</a></h2>
<p>There two ways how you can deploy your multi-site Drupal application via AnaxExp</p>
<h3 id="deploy-sites-as-separate-app-instances">Deploy sites as separate app instances<a class="headerlink" href="#deploy-sites-as-separate-app-instances" title="Permanent link">&para;</a></h3>
<p>Deploy every site as a separate application instance by specifying the <a href="#default-site">default site</a> of every subsite. In this scheme every site will be deployed as a separate <a href="../../apps/instances/">application instance</a> with its own database. </p>
<h3 id="deploy-all-sites-in-one-instance">Deploy all sites in one instance<a class="headerlink" href="#deploy-all-sites-in-one-instance" title="Permanent link">&para;</a></h3>
<p>Perform the following modifications in your code:</p>
<ol>
<li>Add the following include in <code>sites/*/settings.php</code> of all sites, specify db prefix for every site:
    <div class="codehilite"><pre><span></span><span class="x">include &#39;/var/www/conf/anaxexp.settings.php&#39;;</span>
<span class="x">// After the include specify db prefix for every site.</span>
<span class="x">// $databases[&#39;default&#39;][&#39;default&#39;][&#39;prefix&#39;] = &#39;site_prefix_&#39;;</span>
</pre></div></li>
<li>In your <a href="#sites-php"><code>sites.php</code></a> file the following lines with include and your domains to directories mapping:
    <div class="codehilite"><pre><span></span><span class="x">include &#39;/var/www/conf/anaxexp.sites.php&#39;;</span>

<span class="x">// Add mapping after the include to override:</span>
<span class="x">$sites[&#39;your.domain.com&#39;] = &#39;dir.name.under.sites&#39;;</span>
</pre></div></li>
</ol>
<p>Also, you'll have to update <a href="#cron">cron</a> jobs to run it for every site, not only the primary. Please note that all dashboard orchestration such as Drupal cache clear will be applied only to the default site.</p>
<p>In this scheme every site will use the database by default.  </p>
<h2 id="cache-control">Cache control<a class="headerlink" href="#cache-control" title="Permanent link">&para;</a></h2>
<p>You can clear caches and control cache settings from <code>[Instance] &gt; Cache</code> page. The following actions are available:</p>
<ul>
<li>Clear application cache (drush cc)</li>
<li>Clear redis cache (if enabled)</li>
<li>Clear varnish cache (if enabled)</li>
<li>Clear all caches</li>
<li>Enable/disable opcache</li>
<li>Enable/disable redis integration</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
    
    <div class="md-footer-nav">
        <nav class="md-footer-nav__inner md-grid">
            
            <a href="stacks/maintenance/" title="Maintenance" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
                <div class="md-flex__cell md-flex__cell--shrink">
                    <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
                </div>
                <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                Previous
                </span>
              Maintenance
              </span>
                </div>
            </a>
            
            
            <a href="stacks/drupal/containers/" title="Containers" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
                <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                Next
                </span>
              Containers
              </span>
                </div>
                <div class="md-flex__cell md-flex__cell--shrink">
                    <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
                </div>
            </a>
            
        </nav>
    </div>
    
    <div class="md-footer-meta md-typeset">
        <div class="md-footer-meta__inner md-grid">
            <a target="_blank" href="http://anaxexp.com/" title="AnaxExp" class="md-header-nav__button md-logo">
                <img src="../../assets/images/anaxexp-logo.png" width="24" height="24">
            </a>

            
            
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://anaxexp.com" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/anaxexp" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/AnaxExpHQ" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

            
        </div>
    </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.1",url:{base:"../.."}})</script>
      
        <script src="../../assets/anaxexp.js"></script>
      
    
    
      
    
  </body>
</html>